# 链接池和连接复用

如果代理到`Peer`(上游服务器)的请求已处理完成，代理服务器与对端的连接会被添加到一个链接池中，被后续的请求 _复用_ 。这个过程是自动发生的，不需要特别的配置。

请求复用之前已建立的连接，可以避免新建连接所产生延迟和性能消耗，提升Pingora的整体性能和可伸缩性。

## 同一个 `Peer`
只在请求想要连接到完全相同的`Peer`时，连接才可以被复用。为了正确性和安全等因素，两个`Peer`只有在下列属性都相同的情况下才被认为是相同的。
* IP:port
* scheme
* SNI
* client cert
* verify cert
* verify hostname
* alternative_cn
* proxy settings

## 禁用连接池
为了对某个特定的`Peer`禁用连接池和连接复用，只需要在使用此`Peer`的所有请求中将`idle_timeout`设置为0秒。

## 失败
如果在处理请求的过程中出错了，则认为此连接是不可复用的。
